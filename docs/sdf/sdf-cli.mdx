---
sidebar_position: 6
title: "SDF CLI"
description: "Stateful Dataflows Command Line Interface."
slug: /sdf/cli
---

# SDF - Command Line Interface

Stateful Dataflows (sdf) CLI is a binary, shipped with fluvio, that helps developers build, test, and deploy stateful dataflows. The first version works with Rust, and upcoming versions will enable Python and Javascript.

**Commands**

* [sdf setup](#sdf-setup)
* [sdf generate](#sdf-generate)
* [sdf build](#sdf-build)
* [sdf update](#sdf-update)
* [sdf clean](#sdf-clean)
* [sdf log](#sdf-log)
* [sdf version](#sdf-version)
* [sdf run](#sdf-run)
  * [>> show state](#-show-state)
  * [>> exit](#-exit)


### Download FVM and Install SDF

Download [fluvio version manager (fvm)], the package manager for fluvio and sdf:

%copy first-line%
```bash
$ curl -fsS https://hub.infinyon.cloud/install/install.sh | bash
```

This command will download the Fluvio Version Manager (fvm), Fluvio CLI (fluvio) and config files into `$HOME/.fluvio`, with the executables in `$HOME/.fluvio/bin`. To complete the installation, you will need to add the executables to your shell `$PATH`.

Install the preview release:

%copy first-line%
```bash
$ fvm install sdf-preview6
```

SDF has the following comamand hierarchy:

```bash
$ sdf -h
Stateful Dataflow Command Line Interface

Usage: sdf <COMMAND>

Commands:
  clean     Clean generated artifacts such as state and internal objects
  build     Build package (requires: sdf-package.yaml)
  generate  Generate package (requires: sdf-package.yaml)
  update    Update package (requires: sdf-package.yaml)
  run       Run dataflow  (requires: dataflow.yaml)
  setup     Setup pre-requisites for Stateful Dataflows
  test      Test command shell (requires sdf-package.yaml)
  version   Prints binary version
  log       Print dataflow logs
  help      Print this message or the help of the given subcommand(s)
```

### `sdf setup`

Command line syntax for `sdf setup`:
sdf

```bash
$ sdf setup -h
Setup pre-requisites for Stateful Dataflow

Usage: sdf setup
```

Run `sdf setup` to configure your local environment.

%copy first-line%
```bash
$ sdf setup
```


### `sdf generate`

Command line syntax for `sdf generate`:

```bash
$ sdf generate -h
Generate sdf projects from data-pipeline.yaml

Usage: sdf generate
```

##### Example

SDF generate requires a `data-pipeline.yaml` the current directory:

%copy first-line%
```bash
$ sdf generate
```

The command parses the file and creates a Rust project in a subdirectory called `project`. For additional information, check out [Data Pipeline File].


### `sdf build`

Command line syntax for `sdf build`:

```bash
$ sdf build -h
Build Stateful Dataflow

Usage: sdf build
```

##### Example

The command builds the Rust project and generates all WASM Components.

%copy first-line%
```bash
$ sdf build
```

Checkout the `project` directory to see the project hierarchy and the target components.

### `sdf update`

Command line syntax for `sdf update`:

```bash
$ sdf update -h
Update sdf project

Usage: sdf update [OPTIONS]

Options:
  -f, --force    force to apply all updates
  -d, --dry-run  print changes and exit
```

This command is used to update the project based on updated in the `data-pipeline.yaml` file.

The update command makes code changes that cannot be reversed. As a safety measure, the command generates a `diff` and asks for confirmation before proceeding. If you want to bypass the confirmation prompt, use the `-f` and `-d` flags.



### `sdf clean`

Command line syntax for `sdf clean`:

```bash
$  sdf clean -h
Clean generated files from project directory

Usage: sdf clean
```

This command is used to clean-up the project directory and start again.


##### Example

Let's say we made major changes to the `data-pipeline.yaml` file and the previous version is no longer relevant. We can use `clean` to remove the project and start over:

%copy first-line%
```bash
$ sdf clean
```


### `sdf log`

Use `sdf log` to view you print statements:

```bash
$  sdf log -h
Print data pipeline logs

Usage: sdf log [OPTIONS]

Options:
  -f, --follow  Specify if the logs should be streamed
```

Use `--f --follow` option to watch the logs.


##### Example

The following code splits sentences into words and has a `println` statement:

```yaml
- operator: flat-map
  run: |
    fn split_sentence(sentence: String) -> Result<Vec<String>, String> {
      let result = sentence.split_whitespace().map(String::from).collect();
      println!("{:?}", result);

      Ok(result)
    }
```

For the sentence with `This is a test`, the output will be:

%copy first-line%
```bash
$ sdf log
2024-01-06T02:08:09.735861+00:00 split-sentence INFO ["This", "is", "a", "test"]
```


### `sdf version`

Command line syntax for `sdf version`:

```bash
$ sdf version -h
Display version information

Usage: sdf version
```

##### Example

Find out what version you are running:

%copy first-line%
```bash
$ sdf version
```


### `sdf run`

Run the project and open the command line in interactive mode with `sdf run`:

```bash
$ sdf run -h
Run Stateful Dataflow

Usage: sdf run [OPTIONS]

Options:
      --ui           start the workflow viewer ui [env: UI=]
  -p, --port <PORT>  port for web server to listen on [env: PORT=] [default: 8000]
```

Use `--ui` to view a graphical represetation of the project in a web browser. The default port is `8000`, and you may change it with the `--port` flag.


##### Example

Navigate to the project directory, ensure it's built, and `run` to start the project in interactive mode:

%copy first-line%
```bash
$ sdf run --ui
Please visit http://127.0.0.1:8000 to use SDF Studio
...
```

### `>>` - interactive mode

SDF `run` opens the command line in interactive mode:

```bash
>> -h
SDF - Stateful Dataflow CLI

Usage: <COMMAND>

Commands:
  show  Show or List states. Use `show state --help` for more info
  exit  Stop interactive session
```

### `>> show state`

Use `show state` to peak into the internal state objects managed by the system:

Command line syntax for `show state`:

```bash
>> show state -h
List all states or show state for given key

Usage: show state [OPTIONS] [NAMESPACE]

Arguments:
  [NAMESPACE]  namespace of state

Options:
      --key <KEY>        key of state
      --filter <FILTER>  filter regex
```

##### Example

For example, to show all state objects:

%copy first-line%
```bash
>> show state
 Namespace                                     Keys  Type
 word-processing-window/count-per-word/state   22    u32
 word-processing-window/sentence/topic.offset  1     offset
```

The states are organized by namespace where the first keyword is the service name `word-processing-window`, followed by the function name `count-per-word` or topic `sentence`. The `state` is the temporary result computed by the window function, whereas `topic.offset` is the offset of the last record read from the `sentence` topic.

To further inspect the objects, use the `show state` command with the name of the namespace:

%copy first-line%
```bash
>> show state word-processing-window/count-per-word/state
 Key       Value  Window
 book      1      2023-12-28T00:32:00Z:2023-12-28T00:32:20Z
 but       1      2023-12-28T00:32:00Z:2023-12-28T00:32:20Z
...
```

You also have the option to filter the state by key `(--key)`, or a regex `(--filter)` operation.


### `>> exit`

Exit interactive mode:

%copy first-line%
```bash
>> exit
bye!
```


### References
* [dataflow.yaml]

[Fluvio Version Manager (fvm)]: /tutorials/install
[dataflow.yaml]: /sdf/dataflow-yaml
